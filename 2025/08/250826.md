# TIL React 상태관리 심화 - 전역 상태 관리_Redux & Redux Toolkit
## Redux란?
가장 대표적이고 근본인 전역 상태 관리 라이브러리  
상태 관리 라이브러리 중 가장 많이 사용되는 중임
## Redux 데이터 흐름
**FLUX 패턴**  
* **UI**에서 상태 변화가 필요한 이벤트가 발생하면 상태를 어떻게 변화시킬 것 인지 정보를   
담은 **Action**이라는 객체가 만들어지고 Action은 **Dispatch**를 통해서 **Reducer**라는 함수로 전달 됨  

* Reducer에서 Action 객체를 해석하고 그 값에 따라 Store에 들어있는 전역 상태를 변형시킴  
상태가 변경되면 UI가 변경된 상태에 맞춰 리렌더링 됨

### Action
* 상태를 어떻게 변화시킬 것인지에 대한 내용이 담긴 **객체**  

**Action 객체**
```
{
    type: 'INCREMENT'
    paylode: 5
}
```
**Action 생성자**
```
const increment = (num) => ({
    type: 'INCREMENT'
    paylode: num
})
```

### Dispatch
* Action 객체를 Reducer로 넘겨주는 역할을 하는 **함수**  

**Action 객체**
```
dispatch({
    type: 'INCREMENT'
    paylode: 5
})
```
**Action 생성자**
```
dispatch(increment(5))
```

### Reducer
* 리턴하는 값이 **새로운 상태가 되는 함수**

```
const counterReducer = (state, action) => {
    switch (action.type) {
        case 'INCREMENT'
            return state + action.payload
    }
}
```  

#### Reducer가 여러개일 때
* combineReducers 함수로 묶어서 하나로 만들 수 있음
```
const rootReducer = combineReducers({
    counterReducer, anyReducer, ...
})
```
* 전역 상태 저장소에 담아놓고 사용할 상태가 여러 개 === 생성되는 reducer도 여러 개

* combineReducers라는 함수를 호출하면서 인자로 객체 전달 

* 객체 안에 묶어주고 싶은 reducer들을 순서대로 작성해서 전달
### store
* Redux의 **전역 상태 저장소**
* createStore 함수에 Reducer를 전달해서 생성
```
const store = createStore(rootReducer)
```

### 구성요소 모두 생성 완료 시
* React-Redux의 제공 기능 사용

    1. App과 전역 상태 저장소 연결 -> ```<Provider store= { store }>```

    2. 상태 저장소에서 상태 꺼내서 사용 -> useSelector()

    3. dispatch 함수 만들어서 사용 -> useDispatch()
### Redux-Thunk
* Redux에서 비동기 처리를 할 수 있게 해주는 미들웨어

* action으로 객체 말고도 함수 사용 가능하게 해줌

## Redux toolkit이란?
* Redux를 좀 더 쉽게 사용할 수 있도록 만들어진 라이브러리

* 공식문서에서도 사용 권장
## Redux toolkit 데이터 흐름
* Reducer를 받아서 store를 만드는 것은 동일

* 만들어진 store를 앱에 연결하고 상태를 가져와서 컴포넌트에서 사용하고 상태 변경을 일으킬 dispatch함수를 만드는 것은  
react-redux의 기능을 redux에서 사용하는 것처럼 그대로 사용
### createSlice()
* Action 타입, Action 생성자, Reducer 한번에 생성
```
createSlice({name : 'counter', initialState : 0, reducers : {
    increment (state, action) {state +=1},
    decrement (state, action) {state -=1}
}
})
```
### configureStore()
* Reducer를 전달받아 전역 상태 저장소 생성
```
const store = configureStore({
    reducer : {
        counter : counterSlice.reducer,
        any : anySlice.reducer,
        ...
    }
})
```
### Action 생성자 사용법
* createSlice에서 정의해준 redusers 이름으로 사용
```
dispatch( counterSlice.actions.increment())
dispatch( counterSlice.actions.decrement())
```